(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103625,       2389]
NotebookOptionsPosition[    101657,       2330]
NotebookOutlinePosition[    102014,       2346]
CellTagsIndexPosition[    101971,       2343]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "necessary", " ", "for", " ", "removing", " ", 
    "previously", " ", "defined", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{3.6301007913444843`*^9, 3.631359661362054*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Write", " ", "Module", " ", "to", " ", "Count", " ", "number", " ", "of", 
    " ", "roots", " ", "in", " ", "a", " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"From", " ", 
     RowBox[{"https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "physicsforums", ".", "com"}], "/", "threads"}], 
      "/", "find"}], "-", "all", "-", "roots", "-", "of", "-", "an", "-", 
     "interpolating", "-", "function", "-", "in", "-", 
     RowBox[{"mathematica", 
      RowBox[{".612362", "/"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"countZeros", "[", 
    RowBox[{"ifun_", ",", "xmin_", ",", "xmax_", ",", "dx_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zeros", ",", "numZeros"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zeros", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "/.", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ifun", "[", "x", "]"}], "\[Equal]", "0."}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "xInit", ",", "xmin", ",", "xmax"}], "}"}]}],
              "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"xInit", ",", 
             RowBox[{"xmin", "+", "dx"}], ",", 
             RowBox[{"xmax", "-", "dx"}], ",", "dx"}], "}"}]}], "]"}], ",", 
         RowBox[{"SameTest", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#1", "-", "#2"}], "]"}], "<", 
             RowBox[{"10", "^", 
              RowBox[{"-", "4"}]}]}], "&"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numZeros", " ", "=", " ", 
       RowBox[{"Length", "[", "zeros", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "zeros", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "zeros", "]"}], "\[Equal]", "xmax"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ifun", "[", "xmax", "]"}], "\[NotEqual]", "0"}], ",", 
          RowBox[{"numZeros", "=", 
           RowBox[{"numZeros", "-", "1"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "zeros", "]"}], "\[Equal]", "xmin"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ifun", "[", "xmin", "]"}], "\[NotEqual]", "0"}], ",", 
          RowBox[{"numZeros", "=", 
           RowBox[{"numZeros", "-", "1"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "numZeros", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.6301017981900587`*^9}, {3.6301018580554533`*^9, 
   3.630101871252617*^9}, {3.6301019569643*^9, 3.6301019865043716`*^9}, {
   3.6301020394493933`*^9, 3.63010204651302*^9}, {3.630102076588862*^9, 
   3.630102086292461*^9}, {3.6301021616415052`*^9, 3.630102170105464*^9}, {
   3.630102214489914*^9, 3.6301022356372223`*^9}, {3.6301024048609457`*^9, 
   3.630102406853269*^9}, {3.630102444300276*^9, 3.63010244444254*^9}, {
   3.6301026165609007`*^9, 3.630102632497952*^9}, {3.630103335799355*^9, 
   3.6301033858609457`*^9}, 3.631203255751425*^9, {3.631204487745455*^9, 
   3.631204541126915*^9}, {3.631204578781621*^9, 3.631204618514708*^9}, {
   3.631204798123405*^9, 3.631204804473257*^9}, {3.631206750098632*^9, 
   3.6312067905601397`*^9}, {3.631207548170205*^9, 3.631207571639567*^9}, {
   3.631300040558062*^9, 3.6313000944583607`*^9}, {3.631300261986643*^9, 
   3.631300264851232*^9}, 3.631370430850511*^9, {3.631376844040513*^9, 
   3.6313769208989553`*^9}, {3.631377033134266*^9, 3.631377037285449*^9}, {
   3.631377083155622*^9, 3.631377178734151*^9}, {3.6313772525322533`*^9, 
   3.631377257210475*^9}, 3.631377470375277*^9, {3.631377582147644*^9, 
   3.631377645190914*^9}, {3.631377694039156*^9, 3.631377715172462*^9}, {
   3.631377747860551*^9, 3.631377799320774*^9}, {3.6313778828074837`*^9, 
   3.631377885268388*^9}, {3.6313779762981787`*^9, 3.631377993897191*^9}, {
   3.631378842240246*^9, 3.631378893411298*^9}, {3.6313789333832684`*^9, 
   3.6313789365854797`*^9}, {3.6313789703201227`*^9, 3.631378996862191*^9}, {
   3.6313790374137983`*^9, 3.631379038676128*^9}, {3.631379327041008*^9, 
   3.631379336637561*^9}, {3.631379479887459*^9, 3.631379515596889*^9}, {
   3.631379567797516*^9, 3.631379585929515*^9}, 3.631379656422068*^9, {
   3.6313798024776897`*^9, 3.6313798178944273`*^9}, {3.631379972217153*^9, 
   3.631379976333065*^9}, {3.631448530314064*^9, 3.631448661381894*^9}, {
   3.6314487499277573`*^9, 3.63144882459037*^9}, {3.631448927088253*^9, 
   3.631448936788054*^9}, {3.6314638466466618`*^9, 3.631463857791938*^9}, {
   3.631463896670168*^9, 3.631463902371943*^9}, 3.631463948970786*^9, {
   3.631463979425815*^9, 3.631463995736273*^9}, {3.6314640336494827`*^9, 
   3.6314641200991488`*^9}, {3.6314642208727217`*^9, 
   3.6314642450517178`*^9}, {3.631469799644857*^9, 3.63146996964507*^9}, 
   3.6314710681730747`*^9, 3.631471119525909*^9, {3.631471172941272*^9, 
   3.631471200337368*^9}, {3.631471613453528*^9, 3.6314716277399473`*^9}, {
   3.631471855417693*^9, 3.631471896199479*^9}, {3.631471934685771*^9, 
   3.6314719642932873`*^9}, {3.6318004010657663`*^9, 3.631800402217058*^9}, {
   3.631801609140139*^9, 3.631801612772214*^9}, {3.631801715566955*^9, 
   3.631801724464323*^9}, {3.6318019823802423`*^9, 3.631802008539989*^9}, {
   3.631804265907633*^9, 3.631804277708551*^9}, {3.6318045989651003`*^9, 
   3.631804605194875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "^", "4"}], "-", 
   RowBox[{"x", "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"countZeros", "[", 
  RowBox[{"f", ",", 
   RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.6301017981900587`*^9}, {3.6301018580554533`*^9, 
   3.630101871252617*^9}, {3.6301019569643*^9, 3.6301019865043716`*^9}, {
   3.6301020394493933`*^9, 3.63010204651302*^9}, {3.630102076588862*^9, 
   3.630102086292461*^9}, {3.6301021616415052`*^9, 3.630102170105464*^9}, {
   3.630102214489914*^9, 3.6301022356372223`*^9}, {3.6301024048609457`*^9, 
   3.630102406853269*^9}, {3.630102444300276*^9, 3.63010244444254*^9}, {
   3.6301026165609007`*^9, 3.630102632497952*^9}, {3.630103335799355*^9, 
   3.6301033858609457`*^9}, 3.631203255751425*^9, {3.631204487745455*^9, 
   3.631204541126915*^9}, {3.631204578781621*^9, 3.631204618514708*^9}, {
   3.631204798123405*^9, 3.631204804473257*^9}, {3.631206750098632*^9, 
   3.6312067905601397`*^9}, {3.631207548170205*^9, 3.631207571639567*^9}, {
   3.631300040558062*^9, 3.6313000944583607`*^9}, {3.631300261986643*^9, 
   3.631300264851232*^9}, 3.631370430850511*^9, {3.631376844040513*^9, 
   3.6313769208989553`*^9}, {3.631377033134266*^9, 3.631377037285449*^9}, {
   3.631377083155622*^9, 3.631377178734151*^9}, {3.6313772525322533`*^9, 
   3.631377257210475*^9}, 3.631377470375277*^9, {3.631377582147644*^9, 
   3.631377645190914*^9}, {3.631377694039156*^9, 3.631377715172462*^9}, {
   3.631377747860551*^9, 3.631377799320774*^9}, {3.6313778828074837`*^9, 
   3.631377885268388*^9}, {3.6313779762981787`*^9, 3.631377993897191*^9}, {
   3.631378842240246*^9, 3.631378893411298*^9}, {3.6313789333832684`*^9, 
   3.6313789365854797`*^9}, {3.6313789703201227`*^9, 3.631378996862191*^9}, {
   3.6313790374137983`*^9, 3.631379038676128*^9}, {3.631379327041008*^9, 
   3.631379336637561*^9}, {3.631379479887459*^9, 3.631379515596889*^9}, {
   3.631379567797516*^9, 3.631379585929515*^9}, 3.631379656422068*^9, {
   3.6313798024776897`*^9, 3.6313798178944273`*^9}, {3.631379972217153*^9, 
   3.631379976333065*^9}, {3.631448530314064*^9, 3.631448661381894*^9}, {
   3.6314487499277573`*^9, 3.63144882459037*^9}, {3.631448927088253*^9, 
   3.631448936788054*^9}, {3.6314638466466618`*^9, 3.631463857791938*^9}, {
   3.631463896670168*^9, 3.631463902371943*^9}, 3.631463948970786*^9, {
   3.631463979425815*^9, 3.631463995736273*^9}, {3.6314640336494827`*^9, 
   3.6314641200991488`*^9}, {3.6314642208727217`*^9, 
   3.6314642450517178`*^9}, {3.631469799644857*^9, 3.63146996964507*^9}, 
   3.6314710681730747`*^9, 3.631471119525909*^9, {3.631471172941272*^9, 
   3.631471200337368*^9}, {3.631471613453528*^9, 3.6314716277399473`*^9}, {
   3.631471855417693*^9, 3.631471896199479*^9}, {3.631471934685771*^9, 
   3.6314719642932873`*^9}, {3.6318004010657663`*^9, 3.631800402217058*^9}, {
   3.631801609140139*^9, 3.631801645225376*^9}, {3.631801675237816*^9, 
   3.631801677160256*^9}, {3.631801937196937*^9, 3.631801951107877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"countAllZeros", "[", 
   RowBox[{"ifun_", ",", "xmin_", ",", "xmax_", ",", "dx_", ",", "hardLim_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"z", ",", "ztot", ",", "num", ",", "ii"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"z", "=", 
      RowBox[{"countZeros", "[", 
       RowBox[{"ifun", ",", "xmin", ",", "xmax", ",", "dx"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<number of zeros for the function is \>\"", ",", "z"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[Equal]", "0"}], ",", 
       RowBox[{"num", "=", "0"}], ",", 
       RowBox[{"num", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "x_", "]"}], "=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ifun", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "ii"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "x_", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"countZeros", "[", 
          RowBox[{"f", ",", "xmin", ",", "xmax", ",", "dx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of zeros for \>\"", ",", "ii", ",", 
          "\"\<th derivative is \>\"", ",", "z"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ztot", "=", 
         RowBox[{"ztot", "+", "z"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "\[Equal]", "0"}], ",", 
          RowBox[{"num", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[GreaterEqual]", "2"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[GreaterEqual]", "hardLim"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ii", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ztot", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.6301017981900587`*^9}, {3.6301018580554533`*^9, 
   3.630101871252617*^9}, {3.6301019569643*^9, 3.6301019865043716`*^9}, {
   3.6301020394493933`*^9, 3.63010204651302*^9}, {3.630102076588862*^9, 
   3.630102086292461*^9}, {3.6301021616415052`*^9, 3.630102170105464*^9}, {
   3.630102214489914*^9, 3.6301022356372223`*^9}, {3.6301024048609457`*^9, 
   3.630102406853269*^9}, {3.630102444300276*^9, 3.63010244444254*^9}, {
   3.6301026165609007`*^9, 3.630102632497952*^9}, {3.630103335799355*^9, 
   3.6301033858609457`*^9}, 3.631203255751425*^9, {3.631204487745455*^9, 
   3.631204541126915*^9}, {3.631204578781621*^9, 3.631204618514708*^9}, {
   3.631204798123405*^9, 3.631204804473257*^9}, {3.631206750098632*^9, 
   3.6312067905601397`*^9}, {3.631207548170205*^9, 3.631207571639567*^9}, {
   3.631300040558062*^9, 3.6313000944583607`*^9}, {3.631300261986643*^9, 
   3.631300264851232*^9}, 3.631370430850511*^9, {3.631376844040513*^9, 
   3.6313769208989553`*^9}, {3.631377033134266*^9, 3.631377037285449*^9}, {
   3.631377083155622*^9, 3.631377178734151*^9}, {3.6313772525322533`*^9, 
   3.631377257210475*^9}, 3.631377470375277*^9, {3.631377582147644*^9, 
   3.631377645190914*^9}, {3.631377694039156*^9, 3.631377715172462*^9}, {
   3.631377747860551*^9, 3.631377799320774*^9}, {3.6313778828074837`*^9, 
   3.631377885268388*^9}, {3.6313779762981787`*^9, 3.631377993897191*^9}, {
   3.631378842240246*^9, 3.631378893411298*^9}, {3.6313789333832684`*^9, 
   3.6313789365854797`*^9}, {3.6313789703201227`*^9, 3.631378996862191*^9}, {
   3.6313790374137983`*^9, 3.631379038676128*^9}, {3.631379327041008*^9, 
   3.631379336637561*^9}, {3.631379479887459*^9, 3.631379515596889*^9}, {
   3.631379567797516*^9, 3.631379585929515*^9}, 3.631379656422068*^9, {
   3.6313798024776897`*^9, 3.6313798178944273`*^9}, {3.631379972217153*^9, 
   3.631379976333065*^9}, {3.631448530314064*^9, 3.631448661381894*^9}, {
   3.6314487499277573`*^9, 3.63144882459037*^9}, {3.631448927088253*^9, 
   3.631448936788054*^9}, {3.6314638466466618`*^9, 3.631463857791938*^9}, {
   3.631463896670168*^9, 3.631463902371943*^9}, 3.631463948970786*^9, {
   3.631463979425815*^9, 3.631463995736273*^9}, {3.6314640336494827`*^9, 
   3.6314641200991488`*^9}, {3.6314642208727217`*^9, 
   3.6314642450517178`*^9}, {3.631469799644857*^9, 3.63146996964507*^9}, 
   3.6314710681730747`*^9, 3.631471119525909*^9, {3.631471172941272*^9, 
   3.631471200337368*^9}, {3.631471613453528*^9, 3.6314716277399473`*^9}, {
   3.631471855417693*^9, 3.631471896199479*^9}, {3.631471934685771*^9, 
   3.6314719642932873`*^9}, {3.6318004010657663`*^9, 
   3.6318008223395767`*^9}, {3.631800872361885*^9, 3.6318009557235518`*^9}, {
   3.631801104622676*^9, 3.631801136299205*^9}, {3.631801178186408*^9, 
   3.6318012013684893`*^9}, {3.631801242968238*^9, 3.631801284624988*^9}, {
   3.631802086351089*^9, 3.631802113804233*^9}, {3.631802177114675*^9, 
   3.631802211348385*^9}, {3.631802624805231*^9, 3.631802644833816*^9}, {
   3.631803266509959*^9, 3.631803291866222*^9}, {3.631806270205084*^9, 
   3.631806270387207*^9}, {3.631806707426407*^9, 3.631806723505767*^9}, {
   3.632065625738885*^9, 3.632065641122322*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "^", "4"}], "-", 
   RowBox[{"x", "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"countAllZeros", "[", 
  RowBox[{"f", ",", 
   RowBox[{"-", "10"}], ",", "10", ",", "0.1", ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.6301017981900587`*^9}, {3.6301018580554533`*^9, 
   3.630101871252617*^9}, {3.6301019569643*^9, 3.6301019865043716`*^9}, {
   3.6301020394493933`*^9, 3.63010204651302*^9}, {3.630102076588862*^9, 
   3.630102086292461*^9}, {3.6301021616415052`*^9, 3.630102170105464*^9}, {
   3.630102214489914*^9, 3.6301022356372223`*^9}, {3.6301024048609457`*^9, 
   3.630102406853269*^9}, {3.630102444300276*^9, 3.63010244444254*^9}, {
   3.6301026165609007`*^9, 3.630102632497952*^9}, {3.630103335799355*^9, 
   3.6301033858609457`*^9}, 3.631203255751425*^9, {3.631204487745455*^9, 
   3.631204541126915*^9}, {3.631204578781621*^9, 3.631204618514708*^9}, {
   3.631204798123405*^9, 3.631204804473257*^9}, {3.631206750098632*^9, 
   3.6312067905601397`*^9}, {3.631207548170205*^9, 3.631207571639567*^9}, {
   3.631300040558062*^9, 3.6313000944583607`*^9}, {3.631300261986643*^9, 
   3.631300264851232*^9}, 3.631370430850511*^9, {3.631376844040513*^9, 
   3.6313769208989553`*^9}, {3.631377033134266*^9, 3.631377037285449*^9}, {
   3.631377083155622*^9, 3.631377178734151*^9}, {3.6313772525322533`*^9, 
   3.631377257210475*^9}, 3.631377470375277*^9, {3.631377582147644*^9, 
   3.631377645190914*^9}, {3.631377694039156*^9, 3.631377715172462*^9}, {
   3.631377747860551*^9, 3.631377799320774*^9}, {3.6313778828074837`*^9, 
   3.631377885268388*^9}, {3.6313779762981787`*^9, 3.631377993897191*^9}, {
   3.631378842240246*^9, 3.631378893411298*^9}, {3.6313789333832684`*^9, 
   3.6313789365854797`*^9}, {3.6313789703201227`*^9, 3.631378996862191*^9}, {
   3.6313790374137983`*^9, 3.631379038676128*^9}, {3.631379327041008*^9, 
   3.631379336637561*^9}, {3.631379479887459*^9, 3.631379515596889*^9}, {
   3.631379567797516*^9, 3.631379585929515*^9}, 3.631379656422068*^9, {
   3.6313798024776897`*^9, 3.6313798178944273`*^9}, {3.631379972217153*^9, 
   3.631379976333065*^9}, {3.631448530314064*^9, 3.631448661381894*^9}, {
   3.6314487499277573`*^9, 3.63144882459037*^9}, {3.631448927088253*^9, 
   3.631448936788054*^9}, {3.6314638466466618`*^9, 3.631463857791938*^9}, {
   3.631463896670168*^9, 3.631463902371943*^9}, 3.631463948970786*^9, {
   3.631463979425815*^9, 3.631463995736273*^9}, {3.6314640336494827`*^9, 
   3.6314641200991488`*^9}, {3.6314642208727217`*^9, 
   3.6314642450517178`*^9}, {3.631469799644857*^9, 3.63146996964507*^9}, 
   3.6314710681730747`*^9, 3.631471119525909*^9, {3.631471172941272*^9, 
   3.631471200337368*^9}, {3.631471613453528*^9, 3.6314716277399473`*^9}, {
   3.631471855417693*^9, 3.631471896199479*^9}, {3.631471934685771*^9, 
   3.6314719642932873`*^9}, {3.6318004010657663`*^9, 
   3.6318008223395767`*^9}, {3.631800872361885*^9, 3.6318009557235518`*^9}, {
   3.631801104622676*^9, 3.631801136299205*^9}, {3.631801178186408*^9, 
   3.6318012013684893`*^9}, {3.631801242968238*^9, 3.6318013263613863`*^9}, {
   3.63180145539819*^9, 3.6318014685708942`*^9}, {3.631801588410222*^9, 
   3.631801590884554*^9}, {3.631802029440987*^9, 3.6318020399037237`*^9}, {
   3.631806729449765*^9, 3.631806730520248*^9}, 3.631807187020823*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findZ\[Epsilon]", "[", 
   RowBox[{
   "\[Phi]sol_", ",", "nmin_", ",", "nmax_", ",", "dn_", ",", "hardLim_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Epsilon]sr", ",", "f", ",", "z", ",", "num", ",", "ii", ",", "ztot"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]sr", "[", "x_", "]"}], ":=", 
      RowBox[{
       FractionBox["1", "2"], "*", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"vp", "[", "x", "]"}], 
          RowBox[{"v", "[", "x", "]"}]], ")"}], "^", "2"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{"\[Epsilon]sr", "[", 
        RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], "/.", "\[Phi]sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "[", "n", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nmin", ",", "nmax"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"N", ",", "\"\<\[Epsilon]sr\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"countZeros", "[", 
       RowBox[{"f", ",", "nmin", ",", "nmax", ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<number of zeros for \[Epsilon]sr is \>\"", ",", "z"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[Equal]", "0"}], ",", 
       RowBox[{"num", "=", "0"}], ",", 
       RowBox[{"num", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "n_", "]"}], "=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Epsilon]sr", "[", 
             RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], "/.", "\[Phi]sol"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ii"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"f", "[", "n", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "nmin", ",", "nmax"}], "}"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"N", ",", "ii"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "n_", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"countZeros", "[", 
          RowBox[{"f", ",", "nmin", ",", "nmax", ",", "dn"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of zeros for \>\"", ",", "ii", ",", 
          "\"\<th derivative of \[Epsilon] is \>\"", ",", "z"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ztot", "=", 
         RowBox[{"ztot", "+", "z"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "\[Equal]", "0"}], ",", 
          RowBox[{"num", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[GreaterEqual]", "2"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[GreaterEqual]", "hardLim"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ii", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ztot", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.632065658067281*^9, 3.632065756143898*^9}, {
  3.632065787270989*^9, 3.632065904051095*^9}, {3.6320661373422537`*^9, 
  3.632066300853438*^9}, {3.632066333157133*^9, 3.6320663611702967`*^9}, {
  3.632066412165741*^9, 3.632066467066407*^9}, {3.6320665039356823`*^9, 
  3.63206650622268*^9}, {3.632066606802828*^9, 3.632066643671327*^9}, {
  3.632066826943471*^9, 3.632066830695198*^9}, {3.632067072158897*^9, 
  3.632067073054475*^9}, {3.6320696307763166`*^9, 3.632069648686266*^9}, {
  3.6320698026344633`*^9, 3.632069803849359*^9}, {3.632069888652547*^9, 
  3.632069892034321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findZ\[Eta]", "[", 
   RowBox[{
   "\[Phi]sol_", ",", "nmin_", ",", "nmax_", ",", "dn_", ",", "hardLim_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Eta]sr", ",", "f", ",", "z", ",", "num", ",", "ii", ",", "ztot"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Eta]sr", "[", "n_", "]"}], ":=", 
      FractionBox[
       RowBox[{"vpp", "[", 
        RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"\[Phi]", "[", "n", "]"}], "]"}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{"\[Eta]sr", "[", 
        RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], "/.", "\[Phi]sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "[", "n", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nmin", ",", "nmax"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"N", ",", "\"\<\[Eta]sr\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"countZeros", "[", 
       RowBox[{"f", ",", "nmin", ",", "nmax", ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<number of zeros for \[Eta]sr is \>\"", ",", "z"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[Equal]", "0"}], ",", 
       RowBox[{"num", "=", "0"}], ",", 
       RowBox[{"num", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "n_", "]"}], "=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Eta]sr", "[", 
             RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], "/.", "\[Phi]sol"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ii"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"f", "[", "n", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "nmin", ",", "nmax"}], "}"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"N", ",", "ii"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "n_", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"countZeros", "[", 
          RowBox[{"f", ",", "nmin", ",", "nmax", ",", "dn"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of zeros for \>\"", ",", "ii", ",", 
          "\"\<th derivative of \[Eta] is \>\"", ",", "z"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ztot", "=", 
         RowBox[{"ztot", "+", "z"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "\[Equal]", "0"}], ",", 
          RowBox[{"num", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[GreaterEqual]", "2"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[GreaterEqual]", "hardLim"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ii", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ztot", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.632065658067281*^9, 3.632065756143898*^9}, {
  3.632065787270989*^9, 3.632065904051095*^9}, {3.6320661373422537`*^9, 
  3.632066300853438*^9}, {3.632066333157133*^9, 3.6320663611702967`*^9}, {
  3.632066412165741*^9, 3.632066467066407*^9}, {3.6320665039356823`*^9, 
  3.63206650622268*^9}, {3.632066606802828*^9, 3.632066643671327*^9}, {
  3.632066826943471*^9, 3.632066830695198*^9}, {3.632067072158897*^9, 
  3.632067073054475*^9}, {3.6320696307763166`*^9, 3.632069680674712*^9}, {
  3.632069724663924*^9, 3.632069739237893*^9}, {3.632069817521367*^9, 
  3.632069818504171*^9}, {3.632069874661948*^9, 3.6320698836349697`*^9}, {
  3.63225245598943*^9, 3.632252456750738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findH", "[", "v_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "hsq"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", "n_", "]"}], ":=", " ", 
      RowBox[{"Simplify", "[", 
       SqrtBox[
        FractionBox[
         RowBox[{"v", "[", 
          RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
         RowBox[{"3", "-", 
          RowBox[{
           FractionBox["1", "2"], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "n", "]"}], "^", "2"}]}]}]]], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hsq", "[", "n_", "]"}], ":=", 
      FractionBox[
       RowBox[{"v", "[", 
        RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
       RowBox[{"3", "-", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "'"}], "[", "n", "]"}], "^", "2"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"h", ",", "hsq"}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.632065658067281*^9, 3.632065756143898*^9}, {
  3.632065787270989*^9, 3.632065904051095*^9}, {3.6320661373422537`*^9, 
  3.632066300853438*^9}, {3.632066333157133*^9, 3.6320663611702967`*^9}, {
  3.632066412165741*^9, 3.632066467066407*^9}, {3.6320665039356823`*^9, 
  3.63206650622268*^9}, {3.632066606802828*^9, 3.632066643671327*^9}, {
  3.632066826943471*^9, 3.632066830695198*^9}, {3.632067072158897*^9, 
  3.632067073054475*^9}, {3.6320696307763166`*^9, 3.632069680674712*^9}, {
  3.632069724663924*^9, 3.632069739237893*^9}, {3.632069817521367*^9, 
  3.632069818504171*^9}, {3.632069874661948*^9, 3.6320698836349697`*^9}, {
  3.63225245598943*^9, 3.632252456750738*^9}, {3.6322563695637608`*^9, 
  3.632256421221435*^9}, {3.6322564690532627`*^9, 3.632256548301293*^9}, {
  3.632256684910276*^9, 3.6322566883638268`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findICsr", "[", 
   RowBox[{"v_", ",", "vp_", ",", "ni_", ",", "prints_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]0", ",", "f", ",", "\[Phi]i1", ",", "\[Phi]pi1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]0", " ", "=", " ", 
      RowBox[{"x", " ", "/.", " ", 
       RowBox[{"Last", "[", 
        RowBox[{"NSolve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vp", "[", "x", "]"}], "\[Equal]", 
           RowBox[{
            SqrtBox["2"], "*", 
            RowBox[{"v", "[", "x", "]"}]}]}], ",", "x"}], "]"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Phi]0 = \>\"", ",", "\[Phi]0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "t_", "]"}], " ", "=", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"v", "[", "x", "]"}], 
         RowBox[{"vp", "[", "x", "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Phi]0", ",", "t"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"prints", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<f[t] = \>\"", ",", 
           RowBox[{"f", "[", "t", "]"}]}], "]"}]}], "]"}], ";"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Phi]i1", "=", " ", 
        RowBox[{"t", "/.", 
         RowBox[{"Last", "[", 
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{"ni", "\[Equal]", 
             RowBox[{"f", "[", "t", "]"}]}], ",", "t"}], "]"}], "]"}]}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Phi]i1", "=", " ", 
      RowBox[{"t", "/.", 
       RowBox[{"Last", "[", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"ni", "-", 
           RowBox[{"f", "[", "t", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "20"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]pi1", " ", "=", " ", 
      FractionBox[
       RowBox[{"vp", "[", "\[Phi]i1", "]"}], 
       RowBox[{"v", "[", "\[Phi]i1", "]"}]]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"\[Phi]i1", ",", "\[Phi]pi1"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQraXu1D+X/7XjhVkts0H0x9UZ80H0pEWM60D0vs9a
p0F0rP/s+yDahn3pYxAtVKz6HEQf8G19C6KZFJK+gGiZj39/gGgjBfefIPrI
hpus84B0c3UpF4h+ZRCnCKIF7K+B6fWirA4g2mmfIpiedv1G/XwgbTddtA1E
37Ob2g2iL81J7wXRXOsNpoNobaUAML1OL3QeiF4TWDIfRGeu/H/kB5DmYZM4
CqJDuIzW/QLS/0WXbwHRIVsW7gLRhks6j4Do3wpzr4LoVXuib4HoK6bx90G0
VILLCxC9gsvoLYiu8ux/D6ITznP/BNEnd00E0yHpGf9B9CS1+WAaAPw0qUs=

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveKG", "[", 
   RowBox[{
   "hsq_", ",", "vp_", ",", "ni_", ",", "nf_", ",", "\[Phi]i1_", ",", 
    "\[Phi]pi1_", ",", "plots_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[Phi]sol1", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]sol1", " ", "=", " ", 
      RowBox[{"Last", "@", 
       RowBox[{"Last", "@", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"hsq", "[", "n", "]"}], "*", 
               RowBox[{
                RowBox[{"\[Phi]", "''"}], "[", "n", "]"}]}], "+", 
              RowBox[{
               RowBox[{"hsq", "[", "n", "]"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Phi]", "'"}], "[", "n", "]"}], ")"}], "^", 
                "3"}]}], "-", 
              RowBox[{"6", "*", 
               RowBox[{"hsq", "[", "n", "]"}], "*", 
               RowBox[{
                RowBox[{"\[Phi]", "'"}], "[", "n", "]"}]}], "+", 
              RowBox[{"2", "*", 
               RowBox[{"vp", "[", 
                RowBox[{"\[Phi]", "[", "n", "]"}], "]"}]}]}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "ni", "]"}], "==", "\[Phi]i1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "'"}], "[", "ni", "]"}], "==", 
             "\[Phi]pi1"}]}], "}"}], ",", "\[Phi]", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "ni", ",", "nf"}], "}"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "n", "]"}], "/.", "\[Phi]sol1"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nf", ",", 
            RowBox[{"-", "nf"}]}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<\[Phi]sol1\>\""}], "}"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1.2"}]}], "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}]}], "]"}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[Phi]sol1", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzlsoQ3EAx/FZhg5FaqUlnSmsKc0p8rC2GSVJbseTxlqxeVIuJR6UWySt
rViZ7USE0SbtaWkph8gDyb1lxQPRaJE2WnN+/4dvn9ev3NTX2i0WiUQyIags
0Vtd2e/VF0uTThjdtnDQvprihcEv5Rk0NDnDUJ2+/gxzB4pe4EHjVASKadM3
zI8mYpCh6+KQ372XuAUnRoco+KbqlMMc7Q3RJ5XooD4oJy7e3o1xghqHdBo+
ahbm4OWyeR5SPpUDlhY2E71l7W640zLIwd6tJB8TzErLO4IsxXh/BZPSDT9k
/SsBWL42y8M/2nUNPfsdD/CqoisMZcbaV7hJMRE4Um/9hMbzzDg8DdiIrNmS
hPZijtjf9qNM4EsdYuBMz14VLFCcEMOHw1r4obMRM2hPDTyufGqA4woDD0Op
TuI/WgzSGg==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"find\[Epsilon]", "[", 
   RowBox[{"v_", ",", "\[Phi]sol_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]p", ",", "hsq", ",", "\[Epsilon]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]p", "[", "n_", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "n", "]"}], ",", "n"}], "]"}], "/.", 
       "\[Phi]sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hsq", "[", "n_", "]"}], ":=", 
      RowBox[{
       FractionBox[
        RowBox[{"v", "[", 
         RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
        RowBox[{"3", "-", 
         RowBox[{
          FractionBox["1", "2"], "*", 
          RowBox[{
           RowBox[{"\[Phi]p", "[", "n", "]"}], "^", "2"}]}]}]], "/.", 
       "\[Phi]sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "n_", "]"}], " ", "=", " ", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"3", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"\[Phi]p", "[", "n", "]"}], "^", "2"}], 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]p", "[", "n", "]"}], "^", "2"}], "+", 
            RowBox[{"2", "*", 
             FractionBox[
              RowBox[{"v", "[", 
               RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
              RowBox[{"hsq", "[", "n", "]"}]]}]}]]}], "/.", "\[Phi]sol"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[Epsilon]", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzlsoQwEAh/FZhg5FaiUtnSmsKeYUibXNrJYktymloRWbJ7mVeFBukbS2
YmW2RYTRJu1paSkj8kByb1nxQDRaQxtmzv88fP1eP76mu6GDzWKxeHRQmCfX
W1JfK84Wxs0wuKmzQeNynAN6QsITqK41+6E4cfURpvflPMG9mokAZJOaD8gL
RsOQIpUR6N2+5Vhpx4YHCPgiauXDNOkVo5PLkUG5h884f30zYqOVmLiT8F4y
NwPPF7WzkHCKTDA/u47RUdBkhVv1/TbYtRHzhmlTEjIOoIqgHN+0Me6aC6pc
S25YtDLthT+k5RLad1vu4EVxmx9mtiue4TpBBeBQlf4dtp8mR+Cx28Co0upi
0JhrY+xt/BJG8SX2UXCqc6cUZgmOGP37g1L4JjMwJpH2SnhY8lANRwVqL/TF
mxm10WjhH+1v82cZDITKpdCn7FHAf94q5EU=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findNsR", "[", 
   RowBox[{
   "v_", ",", "vp_", ",", "vpp_", ",", "ni_", ",", "nf_", ",", "ni2_", ",", 
    "nf2_", ",", "n1guess_", ",", "plots_", ",", "prints_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "h", ",", "hsq", ",", "\[Phi]0", ",", "f", ",", "\[Phi]i1", ",", 
      "\[Phi]pi1", ",", "\[Phi]sol1", ",", "\[Phi]1p", ",", "h1sq", ",", 
      "\[Epsilon]1", ",", "n1", ",", "\[Phi]f2", ",", "\[Phi]i2", ",", 
      "\[Phi]pi2", ",", "\[Phi]sol2", ",", "\[Phi]2p", ",", "h2sq", ",", 
      "\[Epsilon]2", ",", "ns", ",", "r", ",", "\[Epsilon]sr", ",", 
      "\[Epsilon]srL", ",", "\[Eta]sr", ",", "\[Eta]srL", ",", "Z\[Epsilon]", 
      ",", "Z\[Eta]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Define", " ", "the", " ", "hubble", " ", "parameter"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", ",", "hsq"}], "}"}], "=", 
      RowBox[{"findH", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "slow", " ", "roll", " ", "initial", " ", 
       "conditions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]i1", ",", "\[Phi]pi1"}], "}"}], "=", 
      RowBox[{"findICsr", "[", 
       RowBox[{"v", ",", "vp", ",", "ni", ",", "prints"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Solve", " ", "the", " ", "Klein"}], "-", 
       RowBox[{"Gordon", " ", "equation", " ", "for", " ", 
        RowBox[{"\[Phi]1", "[", "n", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]sol1", " ", "=", " ", 
      RowBox[{"solveKG", "[", 
       RowBox[{
       "hsq", ",", "vp", ",", "ni", ",", "nf", ",", "\[Phi]i1", ",", 
        "\[Phi]pi1", ",", "plots"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "\[Epsilon]1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]1", "=", 
      RowBox[{"find\[Epsilon]", "[", 
       RowBox[{"v", ",", "\[Phi]sol1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<At n = 0\>\"", ",", "\"\<, \[Epsilon]1 = \>\"", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]1", "[", "n", "]"}], "/.", 
           RowBox[{"n", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Epsilon]1", "[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nf", ",", "ni"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<\[Epsilon]1\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nf", ",", 
               RowBox[{"-", "nf"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1.2"}]}], "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}]}], "]"}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Solve", " ", "for", " ", "where", " ", 
        RowBox[{"\[Epsilon]1", "[", "n", "]"}]}], "\[Equal]", "1"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n1", " ", "=", " ", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"n", "/.", 
        RowBox[{"First", "[", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Epsilon]1", "[", "n", "]"}], "-", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n1guess"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<At n1 = \>\"", ",", "n1", ",", "\"\<, \[Epsilon]1 = \>\"", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]1", "[", "n", "]"}], "/.", 
           RowBox[{"n", "\[Rule]", "n1"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Find", " ", "the", " ", "new", " ", "initial", " ", "conditions", " ",
         "and", " ", "re"}], "-", 
       RowBox[{"solve", " ", "the", " ", "KG", " ", "equation"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Phi]i2", " ", "=", " ", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"ni2", "+", "n1"}], "]"}], "/.", "\[Phi]sol1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Phi]i2 = \>\"", ",", "\[Phi]i2"}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Phi]pi2", " ", "=", " ", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "n", "]"}], ",", "n"}], "]"}], "/.", 
         "\[Phi]sol1"}], "/.", 
        RowBox[{"n", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"ni2", "+", "n1"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Phi]pi2 = \>\"", ",", "\[Phi]pi2"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]sol2", " ", "=", " ", 
      RowBox[{"solveKG", "[", 
       RowBox[{
       "hsq", ",", "vp", ",", "ni2", ",", "nf2", ",", "\[Phi]i2", ",", 
        "\[Phi]pi2", ",", "plots"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Note", ":", " ", 
       RowBox[{
       "before", " ", "I", " ", "had", " ", "it", " ", "integrating", " ", 
        "from", " ", "nf2", " ", "to", " ", "ni2"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Phi]sol2[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "60", "]"}], "/.", "\[Phi]sol2"}]}], "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "\[Epsilon]2"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]2", " ", "=", " ", 
      RowBox[{"find\[Epsilon]", "[", 
       RowBox[{"v", ",", "\[Phi]sol2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<At n = 0\>\"", ",", "\"\<, \[Epsilon]1 = \>\"", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]2", "[", "n", "]"}], "/.", 
           RowBox[{"n", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Epsilon]2", "[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nf2", ",", "ni2"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<\[Epsilon]2\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nf2", ",", "ni2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "the", " ", "spectral", " ", 
       RowBox[{"tilt", ":", " ", 
        RowBox[{"ns", "[", "n", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ns", "[", "n_", "]"}], " ", ":=", " ", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", 
        RowBox[{"\[Epsilon]2", "[", "n", "]"}]}], "+", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"\[Epsilon]2", "[", "n", "]"}], "]"}], ",", "n"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ns[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"ns", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", "n_", "]"}], " ", ":=", " ", 
      RowBox[{"16", "*", 
       RowBox[{"\[Epsilon]2", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<r[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"ns", "[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "ni2", ",", "nf2"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<ns\>\""}], "}"}]}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "slow", " ", "roll", " ", "params", " ", "\[Epsilon]sr", 
       " ", "and", " ", "\[Eta]sr"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Epsilon]sr", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "*", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"vp", "[", 
            RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
           RowBox[{"v", "[", 
            RowBox[{"\[Phi]", "[", "n", "]"}], "]"}]], ")"}], "^", "2"}]}], "/.",
        "\[Phi]sol2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Epsilon]srL", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"v", "[", 
            RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], "]"}], ",", "n"}], 
         "]"}]}], "/.", "\[Phi]sol2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Epsilon]sr[0] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Epsilon]sr", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "0"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Epsilon]sr[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Epsilon]sr", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Epsilon]srL[0] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Epsilon]srL", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "0"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Epsilon]srL[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Epsilon]srL", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox["1", "2"], "*", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"vp", "[", "x", "]"}], 
               RowBox[{"v", "[", "x", "]"}]], ")"}], "^", "2"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "30"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Phi]\>\"", ",", "\"\<\[Epsilon][\[Phi]]\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "10"}], "}"}]}]}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Epsilon]sr", "[", "n", "]"}], "]"}], ",", 
              "\"\<\[Epsilon]sr\>\""}], "]"}], ",", 
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]2", "[", "n", "]"}], ",", 
              "\"\<\[Epsilon]2\>\""}], "]"}], ",", 
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Epsilon]srL", "[", "n", "]"}], "]"}], ",", 
              "\"\<\[Epsilon]srL\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nf2", ",", "ni2"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<\[Epsilon]sr\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nf2", ",", "ni2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]sr", "[", "n_", "]"}], ":=", 
      RowBox[{
       FractionBox[
        RowBox[{"vpp", "[", 
         RowBox[{"\[Phi]", "[", "n", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"\[Phi]", "[", "n", "]"}], "]"}]], "/.", "\[Phi]sol2"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]srL", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"vp", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "n", "]"}], "^", "2"}], "]"}], "]"}], ",",
           "n"}], "]"}]}], "/.", "\[Phi]sol2"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Eta]sr[0] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Eta]sr", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "0"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"prints", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Eta]sr[60] = \>\"", ",", 
         RowBox[{
          RowBox[{"\[Eta]sr", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           FractionBox[
            RowBox[{"vpp", "[", "x", "]"}], 
            RowBox[{"v", "[", "x", "]"}]], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "30"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Phi]\>\"", ",", "\"\<\[Eta][\[Phi]]\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "10"}], "}"}]}]}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Eta]sr", "[", "n", "]"}], "]"}], ",", 
              "\"\<\[Eta]sr\>\""}], "]"}], ",", 
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Eta]srL", "[", "n", "]"}], "]"}], ",", 
              "\"\<\[Eta]srL\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nf2", ",", "ni2"}], "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"N", ",", "\"\<\[Eta]sr\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nf2", ",", "ni2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Find", " ", "Z\[Eta]", " ", "and", " ", "Z\[Epsilon]"}], ",", 
       " ", 
       RowBox[{
       "the", " ", "number", " ", "of", " ", "roots", " ", "of", " ", 
        "\[Eta]", " ", "and", " ", "\[Epsilon]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Z\[Epsilon]", " ", "=", " ", 
        RowBox[{"findZ\[Epsilon]", "[", 
         RowBox[{"\[Phi]sol2", ",", "nf2", ",", "ni2", ",", "0.1", ",", "5"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"prints", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Z\[Epsilon] = \>\"", ",", "\[IndentingNewLine]", 
           "Z\[Epsilon]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Z\[Eta]", " ", "=", " ", 
        RowBox[{"countAllZeros", "[", 
         RowBox[{"\[Eta]sr", ",", "nf2", ",", "ni2", ",", "0.1", ",", "5"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"prints", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Z\[Eta] = \>\"", ",", "\[IndentingNewLine]", "Z\[Eta]"}], 
          "]"}]}], "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ns", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "}"}], "]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ns", "[", "n", "]"}], ",", 
        RowBox[{"r", "[", "n", "]"}], ",", "\[Epsilon]sr", ",", "\[Eta]sr", 
        ",", "\[Phi]sol2"}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.6301017981900587`*^9}, {3.6301018580554533`*^9, 
   3.630101871252617*^9}, {3.6301019569643*^9, 3.6301019865043716`*^9}, {
   3.6301020394493933`*^9, 3.63010204651302*^9}, {3.630102076588862*^9, 
   3.630102086292461*^9}, {3.6301021616415052`*^9, 3.630102170105464*^9}, {
   3.630102214489914*^9, 3.6301022356372223`*^9}, {3.6301024048609457`*^9, 
   3.630102406853269*^9}, {3.630102444300276*^9, 3.63010244444254*^9}, {
   3.6301026165609007`*^9, 3.630102632497952*^9}, {3.630103335799355*^9, 
   3.6301033858609457`*^9}, 3.631203255751425*^9, {3.631204487745455*^9, 
   3.631204541126915*^9}, {3.631204578781621*^9, 3.631204618514708*^9}, {
   3.631204798123405*^9, 3.631204804473257*^9}, {3.631206750098632*^9, 
   3.6312067905601397`*^9}, {3.631207548170205*^9, 3.631207571639567*^9}, {
   3.631300040558062*^9, 3.6313000944583607`*^9}, {3.631300261986643*^9, 
   3.631300264851232*^9}, 3.631370430850511*^9, {3.631376844040513*^9, 
   3.6313769208989553`*^9}, {3.631377033134266*^9, 3.631377037285449*^9}, {
   3.631377083155622*^9, 3.631377178734151*^9}, {3.6313772525322533`*^9, 
   3.631377257210475*^9}, 3.631377470375277*^9, {3.631377582147644*^9, 
   3.631377645190914*^9}, {3.631377694039156*^9, 3.631377715172462*^9}, {
   3.631377747860551*^9, 3.631377799320774*^9}, {3.6313778828074837`*^9, 
   3.631377885268388*^9}, {3.6313779762981787`*^9, 3.631377993897191*^9}, {
   3.631378842240246*^9, 3.631378893411298*^9}, {3.6313789333832684`*^9, 
   3.6313789365854797`*^9}, {3.6313789703201227`*^9, 3.631378996862191*^9}, {
   3.6313790374137983`*^9, 3.631379038676128*^9}, {3.631379327041008*^9, 
   3.631379336637561*^9}, {3.631379479887459*^9, 3.631379515596889*^9}, {
   3.631379567797516*^9, 3.631379585929515*^9}, 3.631379656422068*^9, {
   3.6313798024776897`*^9, 3.6313798178944273`*^9}, {3.631379972217153*^9, 
   3.631379976333065*^9}, {3.631448530314064*^9, 3.631448661381894*^9}, {
   3.6314487499277573`*^9, 3.63144882459037*^9}, {3.631448927088253*^9, 
   3.631448936788054*^9}, {3.6314638466466618`*^9, 3.631463857791938*^9}, {
   3.631463896670168*^9, 3.631463902371943*^9}, 3.631463948970786*^9, {
   3.631463979425815*^9, 3.631463995736273*^9}, {3.6314640336494827`*^9, 
   3.6314641200991488`*^9}, {3.6314642208727217`*^9, 3.6314642450517178`*^9}, 
   3.631469799644857*^9, {3.631469984802446*^9, 3.631470061045828*^9}, {
   3.631472250653201*^9, 3.631472261769651*^9}, {3.631472634666017*^9, 
   3.63147273336357*^9}, {3.6314727667214403`*^9, 3.631472812710689*^9}, {
   3.6314728437764063`*^9, 3.631472853325428*^9}, {3.631472888678329*^9, 
   3.6314729110931797`*^9}, {3.6314731499154*^9, 3.631473151944347*^9}, {
   3.631536858118425*^9, 3.631536974245165*^9}, 3.631537009629674*^9, {
   3.6315370476706133`*^9, 3.6315370740800056`*^9}, {3.631537104266694*^9, 
   3.631537108565847*^9}, {3.6315375586275167`*^9, 3.6315375667133627`*^9}, {
   3.631537612466167*^9, 3.631537613081254*^9}, {3.6316346184136868`*^9, 
   3.63163465380927*^9}, {3.6316347032080183`*^9, 3.6316348094328547`*^9}, 
   3.6316348487122803`*^9, {3.631634890446269*^9, 3.631634893814334*^9}, {
   3.631635332650824*^9, 3.631635373607038*^9}, {3.631635750341152*^9, 
   3.631635762860239*^9}, {3.6316361118841953`*^9, 3.631636207285839*^9}, {
   3.631637465529758*^9, 3.631637468373621*^9}, {3.631720398899125*^9, 
   3.631720405743457*^9}, {3.631720561265856*^9, 3.631720577648378*^9}, {
   3.63172066242188*^9, 3.631720666043708*^9}, {3.631720824956338*^9, 
   3.63172083890864*^9}, {3.631720878212511*^9, 3.631720880664631*^9}, {
   3.631720985902676*^9, 3.631720989266903*^9}, {3.631722751133938*^9, 
   3.631722797237199*^9}, {3.631722949679195*^9, 3.631722949964785*^9}, {
   3.63172303465598*^9, 3.631723039601185*^9}, {3.6317230839292192`*^9, 
   3.631723110158289*^9}, {3.631723142366*^9, 3.631723145653104*^9}, {
   3.631723176824144*^9, 3.631723233402643*^9}, {3.631723374122257*^9, 
   3.631723378758871*^9}, {3.631724792736157*^9, 3.63172479354144*^9}, {
   3.631724899626877*^9, 3.631724914833673*^9}, 3.631724973437446*^9, {
   3.631803364855302*^9, 3.631803367932201*^9}, {3.631806751414978*^9, 
   3.63180675677949*^9}, {3.631806831637743*^9, 3.631806833804934*^9}, {
   3.631806886091838*^9, 3.6318068888354397`*^9}, {3.631807044494051*^9, 
   3.631807047303863*^9}, {3.6318072356614733`*^9, 3.631807241240456*^9}, {
   3.631876580691614*^9, 3.631876598594902*^9}, {3.6318772150721817`*^9, 
   3.631877218475401*^9}, {3.631962262519423*^9, 3.631962298243692*^9}, {
   3.632046866530555*^9, 3.632046871568482*^9}, {3.632047365263524*^9, 
   3.632047423281815*^9}, {3.632066661798792*^9, 3.6320666718486347`*^9}, {
   3.632066764829298*^9, 3.6320667665863028`*^9}, {3.632066852492674*^9, 
   3.63206687100261*^9}, 3.632256466814683*^9, {3.632256556477208*^9, 
   3.6322565710658216`*^9}, {3.632256871531988*^9, 3.632256926259632*^9}, {
   3.632256976025621*^9, 3.632256978374608*^9}, {3.6322617140905447`*^9, 
   3.6322617615059643`*^9}, {3.6322628276661463`*^9, 
   3.6322628816392384`*^9}, {3.6322629352348547`*^9, 3.632263027420044*^9}, {
   3.632263637980938*^9, 3.632263670980774*^9}, {3.632263805116811*^9, 
   3.63226381553738*^9}, {3.632263943122085*^9, 3.632263963825371*^9}, {
   3.6322640124312887`*^9, 3.63226401290987*^9}, {3.6322640445175533`*^9, 
   3.632264044971552*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "an", " ", "inflationary", " ", "potential"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"1", "-", 
      RowBox[{
       FractionBox["1", "2"], "*", 
       RowBox[{
        RowBox[{"(", "0.7", ")"}], "^", "2"}], "*", 
       RowBox[{"x", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", "0.03", ")"}], "*", 
       RowBox[{"x", "^", "4"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", "2"], "*", 
        RowBox[{
         RowBox[{"(", "0.7", ")"}], "^", "2"}], "*", 
        RowBox[{"x", "^", "2"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"44", "^", "2"}], "0.7"], ")"}], "*", 
        RowBox[{"x", "^", "4"}]}]}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vp", "[", "x_", "]"}], "=", 
     RowBox[{
      RowBox[{"v", "'"}], "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vpp", "[", "x_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"v", "''"}], "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ni", " ", "=", " ", "80"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "initial", " ", "value", " ", "f", " ", "n", " ", "for", " ", 
     "integration"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nf", " ", "=", " ", 
     RowBox[{"-", "1.2"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "final", " ", "value", " ", "of", " ", "n", " ", "for", " ", 
     "integration"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ni2", " ", "=", " ", "80"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nf2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n1guess", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ns", ",", "r", ",", "\[Epsilon]sr", ",", "\[Eta]sr", ",", 
       "\[Phi]sol"}], "}"}], " ", "=", " ", 
     RowBox[{"findNsR", "[", 
      RowBox[{
      "v", ",", "vp", ",", "vpp", ",", "ni", ",", "nf", ",", "ni2", ",", 
       "nf2", ",", "n1guess", ",", "False", ",", "True"}], "]"}]}], ";"}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Plots", ",", "Prints"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<ns[60] = \>\"", ",", 
      RowBox[{"ns", "/.", 
       RowBox[{"{", 
        RowBox[{"n", "\[Rule]", "60"}], "}"}]}], ",", "\"\< and r[60] = \>\"",
       ",", 
      RowBox[{"r", "/.", 
       RowBox[{"{", 
        RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<ns[50] = \>\"", ",", 
      RowBox[{"ns", "/.", 
       RowBox[{"{", 
        RowBox[{"n", "\[Rule]", "50"}], "}"}]}], ",", "\"\< and r[50] = \>\"",
       ",", 
      RowBox[{"r", "/.", 
       RowBox[{"{", 
        RowBox[{"n", "\[Rule]", "50"}], "}"}]}]}], "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.630101836337913*^9}, {3.630101885452791*^9, 
   3.6301018976074533`*^9}, 3.630102061331112*^9, {3.6301021773643703`*^9, 
   3.630102189697921*^9}, {3.630102287213552*^9, 3.630102319178857*^9}, {
   3.6301026392367887`*^9, 3.630102682736989*^9}, {3.630103391401043*^9, 
   3.630103392438734*^9}, {3.631203098919942*^9, 3.631203099576406*^9}, {
   3.631203143536356*^9, 3.631203144141163*^9}, {3.631203183055718*^9, 
   3.631203214170908*^9}, {3.631203383732376*^9, 3.6312033985206537`*^9}, {
   3.6312034478825703`*^9, 3.631203448007216*^9}, {3.631203685654648*^9, 
   3.6312037173375883`*^9}, {3.631204650711678*^9, 3.6312046508359213`*^9}, {
   3.631205967295719*^9, 3.631205984043292*^9}, {3.631206800109776*^9, 
   3.63120680071528*^9}, {3.631207470011503*^9, 3.6312074918922377`*^9}, {
   3.631207604486774*^9, 3.6312076100445223`*^9}, {3.631207739975278*^9, 
   3.631207743116378*^9}, {3.63130015597322*^9, 3.631300174212083*^9}, {
   3.6313002839365873`*^9, 3.631300340538756*^9}, {3.631300436886985*^9, 
   3.631300439317419*^9}, {3.631372975146393*^9, 3.631372977466618*^9}, {
   3.631377457343912*^9, 3.631377461859639*^9}, {3.631378902258337*^9, 
   3.631378902736855*^9}, {3.6313798995850782`*^9, 3.631379901275914*^9}, {
   3.631379934829368*^9, 3.6313799350498962`*^9}, {3.631448729012566*^9, 
   3.631448745065731*^9}, {3.631448843621827*^9, 3.631448844124136*^9}, {
   3.631464181348667*^9, 3.631464183223939*^9}, {3.63147113052818*^9, 
   3.631471130980319*^9}, {3.6314722684912653`*^9, 3.631472269077036*^9}, {
   3.631472740100518*^9, 3.631472740525371*^9}, {3.631536766940884*^9, 
   3.63153677087362*^9}, 3.631536815824807*^9, {3.6315373125148897`*^9, 
   3.631537320726122*^9}, {3.631537623066874*^9, 3.631537637221031*^9}, {
   3.6316328792069817`*^9, 3.6316329361232653`*^9}, 3.6316329829587812`*^9, {
   3.631633013158024*^9, 3.6316330136915083`*^9}, {3.631633060588997*^9, 
   3.6316330651684628`*^9}, 3.631634252033431*^9, {3.631634285679473*^9, 
   3.6316342862930183`*^9}, {3.6316344876290083`*^9, 
   3.6316344963626137`*^9}, {3.6316349714858093`*^9, 3.631634979866918*^9}, {
   3.631637394849227*^9, 3.631637425330859*^9}, {3.631720362734105*^9, 
   3.631720372035774*^9}, {3.631720413347266*^9, 3.631720456487928*^9}, {
   3.631724100662705*^9, 3.631724108587069*^9}, {3.631806119779916*^9, 
   3.631806129340268*^9}, {3.631806362719493*^9, 3.631806366686512*^9}, {
   3.631876610135572*^9, 3.631876650379869*^9}, {3.632046558477911*^9, 
   3.632046574458645*^9}, {3.6320466047613783`*^9, 3.632046605233419*^9}, {
   3.632047432646296*^9, 3.632047438666604*^9}, {3.6320668769047117`*^9, 
   3.632066915537505*^9}, {3.632070517391848*^9, 3.632070521821342*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Phi]0 = \"\>", "\[InvisibleSpace]", "3.351481621297924`"}],
  SequenceForm["\[Phi]0 = ", 3.351481621297924],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.6322639703745613`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"At n = 0\"\>", "\[InvisibleSpace]", "\<\", \[Epsilon]1 = \"\>",
    "\[InvisibleSpace]", "0.5389692619096469`"}],
  SequenceForm["At n = 0", ", \[Epsilon]1 = ", 0.5389692619096469],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973736929*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \
\[NoBreak]\\!\\({\\(-1.3484099194829156`\\)}\\)\[NoBreak] lies outside the \
range of data in the interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.6322569444343033`*^9, 3.632256990167583*^9, 
  3.632261775127117*^9, 3.632263041804956*^9, 3.632263727897696*^9, 
  3.632263973756051*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \
\[NoBreak]\\!\\({\\(-1.9844507344435685`\\)}\\)\[NoBreak] lies outside the \
range of data in the interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.6322569444343033`*^9, 3.632256990167583*^9, 
  3.632261775127117*^9, 3.632263041804956*^9, 3.632263727897696*^9, 
  3.632263973797559*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \
\[NoBreak]\\!\\({\\(-10.945024277413644`\\)}\\)\[NoBreak] lies outside the \
range of data in the interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.6322569444343033`*^9, 3.632256990167583*^9, 
  3.632261775127117*^9, 3.632263041804956*^9, 3.632263727897696*^9, 
  3.632263973803294*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6322569444343033`*^9, 3.632256990167583*^9, 
  3.632261775127117*^9, 3.632263041804956*^9, 3.632263727897696*^9, 
  3.6322639738088512`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6322569444343033`*^9, 3.632256990167583*^9, 
  3.632261775127117*^9, 3.632263041804956*^9, 3.632263727897696*^9, 
  3.632263973843093*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"At n1 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1.1470090775901849`"}], 
   "\[InvisibleSpace]", "\<\", \[Epsilon]1 = \"\>", "\[InvisibleSpace]", 
   "0.9251025161858617`"}],
  SequenceForm[
  "At n1 = ", -1.1470090775901849`, ", \[Epsilon]1 = ", 0.9251025161858617],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973850482*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Phi]i2 = \"\>", "\[InvisibleSpace]", "25.629390968280124`"}],
  
  SequenceForm["\[Phi]i2 = ", 25.629390968280124`],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973857386*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Phi]pi2 = \"\>", "\[InvisibleSpace]", 
   "0.15672779286247512`"}],
  SequenceForm["\[Phi]pi2 = ", 0.15672779286247512`],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.63226397386582*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Phi]sol2[60] = \"\>", "\[InvisibleSpace]", 
   "22.273440264120072`"}],
  SequenceForm["\[Phi]sol2[60] = ", 22.273440264120072`],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973874337*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"At n = 0\"\>", "\[InvisibleSpace]", "\<\", \[Epsilon]1 = \"\>",
    "\[InvisibleSpace]", "0.9251024681175144`"}],
  SequenceForm["At n = 0", ", \[Epsilon]1 = ", 0.9251024681175144],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973882593*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"ns[60] = \"\>", "\[InvisibleSpace]", "0.9673951461282334`"}], 
   "\[VeryThinSpace]", "-", 
   RowBox[{"0.016387720513834147`", " ", 
    RowBox[{
     SuperscriptBox["Re", "\[Prime]",
      MultilineFunction->None], "[", "0.005434142311961092`", "]"}]}]}],
  SequenceForm[
  "ns[60] = ", 0.9673951461282334 - 0.016387720513834147` 
   Derivative[1][Re][0.005434142311961092]],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973893347*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r[60] = \"\>", "\[InvisibleSpace]", "0.2608388309741324`"}],
  SequenceForm["r[60] = ", 0.2608388309741324],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973903926*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Epsilon]sr[0] = \"\>", "\[InvisibleSpace]", 
   "0.9250989555323785`"}],
  SequenceForm["\[Epsilon]sr[0] = ", 0.9250989555323785],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973910684*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Epsilon]sr[60] = \"\>", "\[InvisibleSpace]", 
   "0.01639209068762523`"}],
  SequenceForm["\[Epsilon]sr[60] = ", 0.01639209068762523],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973917419*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Epsilon]srL[0] = \"\>", "\[InvisibleSpace]", 
   "0.925100711823279`"}],
  SequenceForm["\[Epsilon]srL[0] = ", 0.925100711823279],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973922559*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Epsilon]srL[60] = \"\>", "\[InvisibleSpace]", 
   "0.01634719733658901`"}],
  SequenceForm["\[Epsilon]srL[60] = ", 0.01634719733658901],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973927804*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Eta]sr[0] = \"\>", "\[InvisibleSpace]", "2.53974537137463`"}],
  SequenceForm["\[Eta]sr[0] = ", 2.53974537137463],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973933125*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Eta]sr[60] = \"\>", "\[InvisibleSpace]", 
   "0.024522363749223983`"}],
  SequenceForm["\[Eta]sr[60] = ", 0.024522363749223983`],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.6322639739383574`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"ns[60] = \"\>", "\[InvisibleSpace]", "0.9673951461282334`"}], 
   "\[VeryThinSpace]", "-", 
   RowBox[{
    RowBox[{"0.016387720513834147`", " ", 
     RowBox[{
      SuperscriptBox["Re", "\[Prime]",
       MultilineFunction->None], "[", "0.005434142311961092`", "]"}]}], 
    "\[InvisibleSpace]", "\<\" and r[60] = \"\>", "\[InvisibleSpace]", 
    "0.2608388309741324`"}]}],
  SequenceForm[
  "ns[60] = ", 0.9673951461282334 - 0.016387720513834147` 
   Derivative[1][Re][0.005434142311961092], " and r[60] = ", 
   0.2608388309741324],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973943598*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"ns[50] = \"\>", "\[InvisibleSpace]", "0.9610013272912258`"}], 
   "\[VeryThinSpace]", "-", 
   RowBox[{
    RowBox[{"0.019619625415940072`", " ", 
     RowBox[{
      SuperscriptBox["Re", "\[Prime]",
       MultilineFunction->None], "[", "0.006499778784795706`", "]"}]}], 
    "\[InvisibleSpace]", "\<\" and r[50] = \"\>", "\[InvisibleSpace]", 
    "0.3119893816701939`"}]}],
  SequenceForm[
  "ns[50] = ", 0.9610013272912258 - 0.019619625415940072` 
   Derivative[1][Re][0.006499778784795706], " and r[50] = ", 
   0.3119893816701939],
  Editable->False]], "Print",
 CellChangeTimes->{3.632256756266959*^9, 3.632256944356236*^9, 
  3.632256986801724*^9, 3.632261771682803*^9, 3.632263038370776*^9, 
  3.632263724468431*^9, 3.632263973948936*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z\[Epsilon]", " ", "=", " ", 
   RowBox[{"findZ\[Epsilon]", "[", 
    RowBox[{"\[Phi]sol", ",", "nf2", ",", "ni2", ",", "0.1", ",", "5"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Z\[Epsilon] = \>\"", ",", "Z\[Epsilon]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.6301007913444843`*^9, {3.630100848386307*^9, 3.6301008889363422`*^9}, {
   3.6301010585364017`*^9, 3.630101163612708*^9}, {3.63010132715949*^9, 
   3.630101350628871*^9}, {3.630101434153866*^9, 3.630101705589897*^9}, {
   3.630101750524371*^9, 3.630101836337913*^9}, {3.630101885452791*^9, 
   3.6301018976074533`*^9}, 3.630102061331112*^9, {3.6301021773643703`*^9, 
   3.630102189697921*^9}, {3.630102287213552*^9, 3.630102319178857*^9}, {
   3.6301026392367887`*^9, 3.630102682736989*^9}, {3.630103391401043*^9, 
   3.630103392438734*^9}, {3.631203098919942*^9, 3.631203099576406*^9}, {
   3.631203143536356*^9, 3.631203144141163*^9}, {3.631203183055718*^9, 
   3.631203214170908*^9}, {3.631203383732376*^9, 3.6312033985206537`*^9}, {
   3.6312034478825703`*^9, 3.631203448007216*^9}, {3.631203685654648*^9, 
   3.6312037173375883`*^9}, {3.631204650711678*^9, 3.6312046508359213`*^9}, {
   3.631205967295719*^9, 3.631205984043292*^9}, {3.631206800109776*^9, 
   3.63120680071528*^9}, {3.631207470011503*^9, 3.6312074918922377`*^9}, {
   3.631207604486774*^9, 3.6312076100445223`*^9}, {3.631207739975278*^9, 
   3.631207743116378*^9}, {3.63130015597322*^9, 3.631300174212083*^9}, {
   3.6313002839365873`*^9, 3.631300340538756*^9}, {3.631300436886985*^9, 
   3.631300439317419*^9}, {3.631372975146393*^9, 3.631372977466618*^9}, {
   3.631377457343912*^9, 3.631377461859639*^9}, {3.631378902258337*^9, 
   3.631378902736855*^9}, {3.6313798995850782`*^9, 3.631379901275914*^9}, {
   3.631379934829368*^9, 3.6313799350498962`*^9}, {3.631448729012566*^9, 
   3.631448745065731*^9}, {3.631448843621827*^9, 3.631448844124136*^9}, {
   3.631464181348667*^9, 3.631464183223939*^9}, {3.63147113052818*^9, 
   3.631471130980319*^9}, {3.6314722684912653`*^9, 3.631472269077036*^9}, {
   3.631472740100518*^9, 3.631472740525371*^9}, {3.631536766940884*^9, 
   3.63153677087362*^9}, 3.631536815824807*^9, {3.6315373125148897`*^9, 
   3.631537320726122*^9}, {3.631537623066874*^9, 3.631537637221031*^9}, {
   3.6316328792069817`*^9, 3.6316329361232653`*^9}, 3.6316329829587812`*^9, {
   3.631633013158024*^9, 3.6316330136915083`*^9}, {3.631633060588997*^9, 
   3.6316330651684628`*^9}, 3.631634252033431*^9, {3.631634285679473*^9, 
   3.6316342862930183`*^9}, {3.6316344876290083`*^9, 
   3.6316344963626137`*^9}, {3.6316349714858093`*^9, 3.631634979866918*^9}, {
   3.631637394849227*^9, 3.631637425330859*^9}, {3.631720362734105*^9, 
   3.631720372035774*^9}, {3.631720413347266*^9, 3.631720456487928*^9}, {
   3.631724100662705*^9, 3.631724108587069*^9}, {3.631806119779916*^9, 
   3.631806129340268*^9}, {3.631806362719493*^9, 3.631806366686512*^9}, {
   3.631876610135572*^9, 3.631876650379869*^9}, {3.632046558477911*^9, 
   3.632046574458645*^9}, {3.6320466047613783`*^9, 3.632046605233419*^9}, {
   3.632047432646296*^9, 3.632047438666604*^9}, {3.6320668769047117`*^9, 
   3.632066946231606*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z\[Eta]", " ", "=", " ", 
   RowBox[{"findZ\[Eta]", "[", 
    RowBox[{"\[Phi]sol", ",", "nf2", ",", "ni2", ",", "0.1", ",", "5"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Z\[Eta] = \>\"", ",", "Z\[Eta]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6320697623916903`*^9, 3.632069777328669*^9}}],

Cell[BoxData[{
 RowBox[{"MaxValue", "[", 
  RowBox[{
   RowBox[{"\[Epsilon]sr", "[", "n", "]"}], ",", "n"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"\[Epsilon]sr", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Epsilon]sr\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "n_", "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]sr", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"f1", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Epsilon]sr1\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f2", "[", "n_", "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]sr", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MaxValue", "[", 
  RowBox[{
   RowBox[{"f2", "[", "n", "]"}], ",", "n"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"f2", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Epsilon]sr2\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.631876692307591*^9, 3.631876762701713*^9}, {
  3.631876796885508*^9, 3.631876853696003*^9}, {3.6318770600276318`*^9, 
  3.631877067776841*^9}, {3.631877109564117*^9, 3.631877170163568*^9}, {
  3.631877290962335*^9, 3.6318772999402847`*^9}, {3.6318773363516703`*^9, 
  3.631877362347093*^9}, {3.631877411478229*^9, 3.6318774244115868`*^9}, {
  3.631918275364867*^9, 3.6319183268994923`*^9}, {3.631918361187961*^9, 
  3.631918368096958*^9}, {3.6319641620904303`*^9, 3.631964238538683*^9}}],

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"\[Eta]sr", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Eta]sr1\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "n_", "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Eta]sr", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"f1", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Eta]sr1\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f2", "[", "n_", "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Eta]sr", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"f2", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "80"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"N", ",", "\"\<\[Eta]sr2\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.631877447025749*^9, 3.631877470837179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Loop", " ", "over", " ", "several", " ", "monomial", " ", "potentials", 
    " ", "and", " ", "generate", " ", "and", " ", "ns", " ", "vs", " ", "r", 
    " ", "plot"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ni", " ", "=", " ", "80"}], ";", " ", 
    RowBox[{"nf", " ", "=", " ", 
     RowBox[{"-", "1.2"}]}], ";", " ", 
    RowBox[{"ni2", " ", "=", " ", "80"}], ";", " ", 
    RowBox[{"nf2", " ", "=", " ", "0"}], ";", " ", 
    RowBox[{"n1guess", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pList", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"2", "/", "3"}], ",", "1", ",", "3", ",", "4"}], "}"}]}], ";", 
    
    RowBox[{"plotList", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clrList", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "Black", ",", "Red", ",", "Yellow", ",", "Green", ",", "Purple"}], 
      "}"}]}], ";", " ", 
    RowBox[{"ii", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nsmin", " ", "=", " ", "0.92"}], ";", " ", 
    RowBox[{"nsmax", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"rmin", " ", "=", " ", "0"}], ";", " ", 
    RowBox[{"rmax", " ", "=", " ", "0.35"}]}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"v", ",", "vp", ",", "ns", ",", "r"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "[", "\[Phi]_", "]"}], " ", ":=", " ", 
       RowBox[{"\[Phi]", "^", "p"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vp", "[", "x_", "]"}], "=", 
       RowBox[{
        RowBox[{"v", "'"}], "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vpp", "[", "x_", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"v", "''"}], "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ns", ",", "r"}], "}"}], " ", "=", " ", 
       RowBox[{"findNsR", "[", 
        RowBox[{
        "v", ",", "vp", ",", "vpp", ",", "ni", ",", "nf", ",", "ni2", ",", 
         "nf2", ",", "n1guess", ",", "False", ",", "False"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"plotList", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ns", "/.", 
               RowBox[{"{", 
                RowBox[{"n", "\[Rule]", "50"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", "/.", 
               RowBox[{"{", 
                RowBox[{"n", "\[Rule]", "50"}], "}"}]}], "}"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nsmin", ",", "nsmax"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rmin", ",", "rmax"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ns\>\"", ",", "\"\<r\>\""}], "}"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "12"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"clrList", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"PointLegend", "[", 
            RowBox[{"Automatic", ",", 
             RowBox[{"{", "\"\<N=50\>\"", "}"}], ",", 
             RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}]}], 
            "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"plotList", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ns", "/.", 
               RowBox[{"{", 
                RowBox[{"n", "\[Rule]", "60"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", "/.", 
               RowBox[{"{", 
                RowBox[{"n", "\[Rule]", "60"}], "}"}]}], "}"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nsmin", ",", "nsmax"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rmin", ",", "rmax"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ns\>\"", ",", "\"\<r\>\""}], "}"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "20"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"clrList", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"PointLegend", "[", 
            RowBox[{"Automatic", ",", "\"\<N=60\>\"", ",", 
             RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}]}], 
            "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"plotList", ",", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ns", "/.", 
                 RowBox[{"{", 
                  RowBox[{"n", "\[Rule]", "50"}], "}"}]}], ",", 
                RowBox[{"r", "/.", 
                 RowBox[{"{", 
                  RowBox[{"n", "\[Rule]", "50"}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ns", "/.", 
                 RowBox[{"{", 
                  RowBox[{"n", "\[Rule]", "60"}], "}"}]}], ",", 
                RowBox[{"r", "/.", 
                 RowBox[{"{", 
                  RowBox[{"n", "\[Rule]", "60"}], "}"}]}]}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"V", "\[Proportional]", 
             RowBox[{"\[Phi]", "^", 
              RowBox[{"pList", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nsmin", ",", "nsmax"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rmin", ",", "rmax"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ns\>\"", ",", "\"\<r\>\""}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"clrList", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ii", " ", "=", " ", 
       RowBox[{"ii", "+", "1"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "pList"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "plotList", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.630102832406712*^9, 3.630102899988802*^9}, {
   3.630102942971344*^9, 3.630103018712843*^9}, {3.630103051151935*^9, 
   3.6301033013490047`*^9}, {3.630103395416753*^9, 3.630103397057214*^9}, {
   3.6301034316417017`*^9, 3.630103479762631*^9}, {3.630103655172037*^9, 
   3.6301036677853327`*^9}, {3.630146833821704*^9, 3.630146922064196*^9}, {
   3.631204910970312*^9, 3.631204911159399*^9}, {3.631205312981789*^9, 
   3.631205473844836*^9}, 3.6312055256362753`*^9, {3.631205616654118*^9, 
   3.6312056313484898`*^9}, {3.631205726463677*^9, 3.631205897815702*^9}, {
   3.631206147572894*^9, 3.631206220066553*^9}, {3.631206261322081*^9, 
   3.631206310147705*^9}, {3.631206348439479*^9, 3.631206415695327*^9}, {
   3.63120645690576*^9, 3.631206513985361*^9}, {3.631206580080002*^9, 
   3.6312066195497637`*^9}, {3.63120681596455*^9, 3.631206816073131*^9}, {
   3.63135876067491*^9, 3.631358774217297*^9}, {3.631358821055901*^9, 
   3.6313589324770317`*^9}, {3.63135914640466*^9, 3.63135921644681*^9}, {
   3.6313592638044157`*^9, 3.631359315804421*^9}, {3.6313593573083467`*^9, 
   3.631359361367585*^9}, {3.6313594831642237`*^9, 3.631359485309482*^9}, {
   3.631362955423962*^9, 3.631362984915049*^9}, {3.631363023962932*^9, 
   3.6313630359694853`*^9}, {3.6313630738183737`*^9, 
   3.6313630997579327`*^9}, {3.6313631374636173`*^9, 3.631363150810767*^9}, {
   3.631363192643314*^9, 3.63136320216439*^9}, {3.631363248632596*^9, 
   3.631363302020608*^9}, {3.631363390091036*^9, 3.631363432802524*^9}, {
   3.631363626566331*^9, 3.631363628054034*^9}, {3.631363722986992*^9, 
   3.631363737110606*^9}, {3.631363800374297*^9, 3.631363811349791*^9}, {
   3.631363845362145*^9, 3.6313638543146152`*^9}, {3.631363918384696*^9, 
   3.6313639875356703`*^9}, {3.631364023907938*^9, 3.631364057018648*^9}, {
   3.631364195224567*^9, 3.6313641983237343`*^9}, 3.63136561749067*^9, 
   3.631365660800721*^9, {3.631366041442607*^9, 3.631366200459556*^9}, {
   3.63136642976965*^9, 3.6313664551631813`*^9}, {3.631368939690263*^9, 
   3.631368946555808*^9}, {3.631374321369422*^9, 3.631374355957471*^9}, {
   3.631448700372717*^9, 3.631448718051959*^9}}]
},
WindowSize->{724, 802},
WindowMargins->{{47, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 358, 8, 46, "Input"],
Cell[919, 30, 6167, 123, 199, "Input"],
Cell[7089, 155, 3322, 50, 46, "Input"],
Cell[10414, 207, 6110, 113, 301, "Input"],
Cell[16527, 322, 3616, 54, 46, "Input"],
Cell[20146, 378, 5131, 125, 448, "Input"],
Cell[25280, 505, 5152, 124, 448, "Input"],
Cell[30435, 631, 2014, 48, 182, "Input"],
Cell[32452, 681, 2954, 81, 246, "Input"],
Cell[35409, 764, 3203, 82, 182, "Input"],
Cell[38615, 848, 2179, 57, 188, "Input"],
Cell[40797, 907, 25531, 590, 1413, "Input"],
Cell[CellGroupData[{
Cell[66353, 1501, 6278, 139, 297, "Input"],
Cell[CellGroupData[{
Cell[72656, 1644, 371, 7, 21, "Print"],
Cell[73030, 1653, 440, 8, 21, "Print"]
}, Open  ]],
Cell[73485, 1664, 710, 15, 42, "Message"],
Cell[74198, 1681, 710, 15, 42, "Message"],
Cell[74911, 1698, 710, 15, 42, "Message"],
Cell[75624, 1715, 665, 13, 24, "Message"],
Cell[76292, 1730, 806, 15, 77, "Message"],
Cell[CellGroupData[{
Cell[77123, 1749, 532, 11, 21, "Print"],
Cell[77658, 1762, 377, 8, 21, "Print"],
Cell[78038, 1772, 381, 8, 22, "Print"],
Cell[78422, 1782, 390, 8, 21, "Print"],
Cell[78815, 1792, 440, 8, 21, "Print"],
Cell[79258, 1802, 648, 15, 21, "Print"],
Cell[79909, 1819, 367, 7, 21, "Print"],
Cell[80279, 1828, 391, 8, 21, "Print"],
Cell[80673, 1838, 395, 8, 21, "Print"],
Cell[81071, 1848, 391, 8, 21, "Print"],
Cell[81465, 1858, 397, 8, 21, "Print"],
Cell[81865, 1868, 375, 7, 22, "Print"],
Cell[82243, 1877, 392, 8, 22, "Print"],
Cell[82638, 1887, 807, 19, 21, "Print"],
Cell[83448, 1908, 807, 19, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[84282, 1931, 3257, 50, 46, "Input"],
Cell[87542, 1983, 390, 9, 46, "Input"],
Cell[87935, 1994, 2581, 68, 131, "Input"],
Cell[90519, 2064, 1536, 46, 97, "Input"],
Cell[92058, 2112, 9595, 216, 454, "Input"]
}
]
*)

(* End of internal cache information *)
